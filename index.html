<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="websiteTitle">Tee & Me - Our Story</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next@23.7.16/dist/umd/i18next.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/i18next-browser-languagedetector@7.2.0/dist/umd/i18nextBrowserLanguageDetector.min.js"></script>

    <style>
        /* Custom Styles V6 - Strict no-scroll, functional focus */
        html, body { height: 100%; margin: 0; padding: 0; overflow: hidden; font-family: 'Inter', sans-serif; color: #333; background-color: #f0f0f0; /* Fallback bg */ }
        #videoBackground { position: fixed; right: 0; bottom: 0; min-width: 100%; min-height: 100%; width: auto; height: auto; z-index: -1000; background-size: cover; filter: blur(5px) brightness(0.55); object-fit: cover; }
        .main-container { display: flex; flex-direction: column; height: 100vh; width: 100vw; position: relative; z-index: 1; }
        
        header { background-color: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); box-shadow: 0 2px 5px rgba(0,0,0,0.07); position: fixed; top: 0; left: 0; width: 100%; z-index: 1000; }
        nav { background-color: rgba(255, 255, 255, 0.98); backdrop-filter: blur(10px); box-shadow: 0 2px 5px rgba(0,0,0,0.07); position: fixed; /* top will be set by JS */ left: 0; width: 100%; z-index: 999; }
        nav .container { overflow-x: auto; -ms-overflow-style: none; scrollbar-width: none; display: flex; justify-content: center; align-items: center; height: 100%; }
        nav .container::-webkit-scrollbar { display: none; }
        .nav-button { transition: all 0.25s ease; border-bottom: 3px solid transparent; white-space: nowrap; padding: 0.7rem 0.85rem; font-size: 0.9rem; font-weight: 500; cursor: pointer; }
        .nav-button.active-nav, .nav-button:hover { color: #b91c1c; /* Darker Rose */ border-bottom-color: #b91c1c; }

        .content-area-wrapper { flex-grow: 1; display: flex; justify-content: center; align-items: center; padding-top: 0; /* Header/Nav are fixed, JS will set this */ overflow: hidden; width: 100%; }
        .content-area { width: calc(100% - 1.5rem); max-width: 1600px; height: calc(100% - 1.5rem); margin: 0.75rem; background-color: rgba(253, 242, 242, 0.95); /* Lighter rose, more opaque */ border-radius: 0.75rem; box-shadow: 0 15px 30px rgba(0,0,0,0.2); position: relative; overflow: hidden; display: flex; flex-direction: column; }
        
        .content-section { display: none; width: 100%; height: 100%; overflow: hidden; padding: 1.25rem; animation: fadeIn 0.5s ease-out; flex-direction: column; }
        .content-section.active { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.98); } to { opacity: 1; transform: scale(1); } }

        .section-header { text-align: center; margin-bottom: 0.75rem; flex-shrink: 0; }
        .section-header h2 { font-size: 2rem; font-weight: 700; color: #991b1b; /* Darker Rose */ }
        .section-content-wrapper { flex-grow: 1; overflow: hidden; display: flex; flex-direction: column; }
        
        .sub-nav-tabs { display: flex; justify-content: center; margin-bottom: 0.75rem; flex-shrink: 0; border-bottom: 1px solid #e5e7eb; }
        .sub-nav-tab { padding: 0.4rem 0.9rem; margin: 0 0.2rem; cursor: pointer; border-bottom: 2px solid transparent; transition: all 0.2s; font-weight: 500; color: #374151; font-size: 0.85rem; }
        .sub-nav-tab.active-sub-nav, .sub-nav-tab:hover { color: #991b1b; border-bottom-color: #991b1b; }
        
        .sub-content { display: none; flex-grow: 1; overflow-y: auto; /* Primary scroll for sub-content */ padding: 0.75rem; border-radius: 0.25rem; background-color: rgba(255,255,255,0.6); }
        .sub-content.active-sub-content { display: block; } /* Changed to block to allow internal flow */

        .carousel-container { display: flex; overflow-x: auto; scroll-behavior: smooth; padding: 0.5rem 0 1rem 0; -webkit-overflow-scrolling: touch; flex-shrink: 0; }
        .carousel-item { flex: 0 0 auto; width: 280px; margin-right: 1rem; background-color: #ffffff; border-radius: 0.5rem; box-shadow: 0 3px 7px rgba(0,0,0,0.12); padding: 1rem; }
        .carousel-item:last-child { margin-right: 0; }
        
        .carousel-navigation-wrapper { position:relative; flex-shrink:0; /* For carousels taking full height like overview timeline */ }
        .carousel-nav-btn { background-color: rgba(255,255,255,0.9); border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; box-shadow: 0 1px 4px rgba(0,0,0,0.25); cursor: pointer; color: #991b1b; position: absolute; top: 50%; transform: translateY(-50%); z-index: 10;}
        .carousel-nav-btn.prev { left: 5px; }
        .carousel-nav-btn.next { right: 5px; }
        .carousel-nav-btn:hover { background-color: white; }
        
        .modal { display: none; position: fixed; z-index: 1050; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); }
        .modal-content { background-color: #fff; margin: 3% auto; padding: 25px; border: 0; width: 90%; max-width: 750px; border-radius: 0.75rem; position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .close-button { color: #777; position: absolute; right: 15px; top: 10px; font-size: 30px; font-weight: bold; line-height: 1; }
        .close-button:hover, .close-button:focus { color: #111; text-decoration: none; cursor: pointer; }
        
        #playlistButton { position: fixed; bottom: 15px; right: 15px; z-index: 1010; background-color: #c2173c; color: white; width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; box-shadow: 0 3px 10px rgba(0,0,0,0.25); cursor: pointer; transition: transform 0.2s; }
        #playlistButton:hover { transform: scale(1.1); }
        #playlistModal .modal-content { max-width: 580px; }
        #playlistModal iframe { border-radius: 0.5rem; width: 100%; aspect-ratio: 16 / 9; }

        .overview-image-carousel .carousel-item { width: 100%; height: 100%; padding:0; background:transparent; box-shadow: none; position: absolute; top:0; left:0; opacity: 0; transition: opacity 1.2s ease-in-out; }
        .overview-image-carousel .carousel-item.active-slide { opacity: 1; z-index: 1; }
        #overviewImageCarouselContainer { position: relative; width: 100%; height: 100%; overflow: hidden; border-radius: 0.5rem; box-shadow: 0 6px 12px rgba(0,0,0,0.15); }
        #overviewImageCarouselContainer img { width:100%; height: 100%; object-fit: cover; }

        .action-button { background-color: #c2173c; color: white; font-weight: 500; padding: 0.6rem 1.2rem; border-radius: 0.375rem; transition: background-color 0.2s ease, transform 0.1s ease; box-shadow: 0 2px 5px rgba(194, 23, 60, 0.25); cursor:pointer; }
        .action-button:hover { background-color: #991b1b; transform: translateY(-1px); }
        .action-button:active { transform: translateY(0px); }
        .input-field, .textarea-field, .select-field { border: 1px solid #d1d5db; padding: 0.6rem 0.8rem; border-radius: 0.375rem; width: 100%; margin-bottom: 0.75rem; background-color: #fdfdfe; box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); }
        .table-wrapper { flex-grow: 1; overflow-y: auto; border: 1px solid #e5e7eb; border-radius: 0.375rem;}

        /* Ensure chart canvas has a defined size or its container does */
        .chart-container { position: relative; width:100%; height:100%; min-height: 200px; /* Ensure charts are visible */ }

    </style>
</head>
<body>
    <video autoplay muted loop playsinline id="videoBackground">
        <source src="assets/videos/our_moments_placeholder.mp4" type="video/mp4">
        Your browser does not support the video tag.
    </video>

    <div class="main-container" id="mainContainer">
        <header id="appHeader">
            <div class="container mx-auto px-4 sm:px-6 py-2.5 flex justify-between items-center">
                <h1 class="text-xl sm:text-2xl font-bold text-rose-700" data-i18n="headerTitle">Tee & Me</h1>
                <div class="language-switcher">
                    <button id="lang-en" class="text-xs sm:text-sm action-button !bg-rose-600 !px-2.5 !py-1 sm:!px-3 sm:!py-1.5">EN</button>
                    <button id="lang-xh" class="text-xs sm:text-sm action-button !bg-rose-600 !px-2.5 !py-1 sm:!px-3 sm:!py-1.5">XH</button>
                </div>
            </div>
        </header>

        <nav id="appNav">
            <div class="container mx-auto px-2 sm:px-4 py-1.5 flex items-center">
                <button data-section="overview" class="nav-button active-nav" data-i18n="nav.overview">Overview</button>
                <button data-section="analysisHub" class="nav-button" data-i18n="nav.analysisHub">Analysis Hub</button>
                <button data-section="mediaTravelHub" class="nav-button" data-i18n="nav.mediaTravelHub">Media & Travel</button>
                <button data-section="connectResolve" class="nav-button" data-i18n="nav.connectResolve">Connect & Resolve</button>
                <button data-section="lifesyncFun" class="nav-button" data-i18n="nav.lifesyncFun">LifeSync & Fun</button>
            </div>
        </nav>
        
        <div class="content-area-wrapper" id="contentAreaWrapper">
            <main class="content-area">
                <section id="overview" class="content-section active">
                    <div class="section-header"> <h2 data-i18n="overview.title"></h2> </div>
                    <div class="section-content-wrapper grid grid-cols-1 lg:grid-cols-5 gap-3 h-full">
                        <div class="lg:col-span-2 space-y-3 flex flex-col overflow-hidden p-0.5">
                            <div class="bg-white/80 p-3 rounded-lg shadow-md flex-shrink-0">
                                <h3 class="text-lg font-semibold mb-2 text-center text-gray-700" data-i18n="overview.dashboardTitle"></h3>
                                <div class="grid grid-cols-2 gap-2.5 mb-2">
                                    <div class="dashboard-metric-card !p-2.5 text-xs"> <h3 data-i18n="overview.affectionLevel" class="!text-sm !font-medium"></h3> <p class="text-xl font-bold" id="affection-metric">--</p> </div>
                                    <div class="dashboard-metric-card !p-2.5 text-xs"> <h3 data-i18n="overview.supportScore" class="!text-sm !font-medium"></h3> <p class="text-xl font-bold" id="support-metric">--</p> </div>
                                    <div class="dashboard-metric-card !p-2.5 text-xs"> <h3 data-i18n="overview.foodContribution" class="!text-sm !font-medium"></h3> <p class="text-xl font-bold" id="food-metric">--</p> </div>
                                    <div class="dashboard-metric-card !p-2.5 text-xs"> <h3 data-i18n="overview.safetyFeeling" class="!text-sm !font-medium"></h3> <p class="text-xl font-bold" id="safety-metric">--</p> </div>
                                </div>
                            </div>
                            <div class="bg-white/80 p-3 rounded-lg shadow-md text-center flex-shrink-0">
                                <h3 class="text-lg font-semibold mb-1.5 text-rose-700" data-i18n="overview.ourSong"></h3>
                                <p class="text-gray-600 mb-1.5 text-xs" id="specialSongTitle" data-i18n="overview.songName_shaggy"></p>
                                <a href="https://youtu.be/DOcCQ-kC4iE?si=DrJURhh0p86ce7yt" target="_blank" class="action-button !text-xs !py-1 !px-2.5"> <i class="fas fa-headphones-alt mr-1"></i> <span data-i18n="overview.listenToSong"></span> </a>
                            </div>
                             <div class="bg-white/80 p-3 rounded-lg shadow-md flex-grow overflow-hidden carousel-navigation-wrapper">
                                <h3 class="text-lg font-semibold mb-1.5 text-center text-gray-700" data-i18n="overview.quickTimeline"></h3>
                                <div id="overviewTimelineCarousel" class="carousel-container h-[calc(100%-2.5rem)]"></div>
                                <button id="overview-timeline-prev" class="carousel-nav-btn prev"><i class="fas fa-chevron-left"></i></button>
                                <button id="overview-timeline-next" class="carousel-nav-btn next"><i class="fas fa-chevron-right"></i></button>
                            </div>
                        </div>
                        <div class="lg:col-span-3 flex flex-col space-y-3 overflow-hidden p-0.5">
                            <div id="overviewImageCarouselContainer" class="relative h-2/5 w-full rounded-lg shadow-lg overflow-hidden flex-shrink-0">
                                <div id="overviewImageCarousel" class="carousel-container overview-image-carousel h-full"></div>
                                <button id="overview-img-prev" class="carousel-nav-btn prev"><i class="fas fa-chevron-left"></i></button>
                                <button id="overview-img-next" class="carousel-nav-btn next"><i class="fas fa-chevron-right"></i></button>
                            </div>
                            <div class="chart-container flex-grow !max-w-none !h-auto bg-white/80 p-3 rounded-lg shadow-md"> <canvas id="dashboardChart"></canvas> </div>
                        </div>
                    </div>
                </section>

                <section id="analysisHub" class="content-section">
                    <div class="section-header"> <h2 data-i18n="nav.analysisHub"></h2> </div>
                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab active-sub-nav" data-subtarget="analysis-tracking" data-i18n="analysisHub.tracking"></button>
                        <button class="sub-nav-tab" data-subtarget="analysis-contributions" data-i18n="analysisHub.contributions"></button>
                        <button class="sub-nav-tab" data-subtarget="analysis-reinforcement" data-i18n="analysisHub.reinforcement"></button>
                    </div>
                    <div class="section-content-wrapper">
                        <div id="analysis-tracking" class="sub-content active-sub-content flex flex-col items-center">
                            <div class="mb-3 text-center flex-shrink-0"> <label for="trackingMetricSelect" class="mr-1.5 font-medium text-gray-700 text-sm" data-i18n="tracking.selectAspect"></label> <select id="trackingMetricSelect" class="select-field w-auto inline-block !py-1.5 !text-sm"></select> </div>
                            <div class="chart-container w-full flex-grow !bg-white/80 !p-2.5"> <canvas id="trackingChart"></canvas> </div>
                        </div>
                        <div id="analysis-contributions" class="sub-content flex flex-col">
                            <div class="mb-3 text-center flex-shrink-0"> <label for="contributionFilterWeek" class="mr-1.5 font-medium text-gray-700 text-sm" data-i18n="contributions.filterWeek"></label> <select id="contributionFilterWeek" class="select-field w-auto inline-block !py-1.5 !text-sm"></select> </div>
                            <div class="table-wrapper bg-white/80 shadow-md rounded-lg flex-grow"> <table class="min-w-full divide-y divide-gray-200 contribution-table"> <thead class="sticky top-0 bg-rose-50 z-10"><tr> <th data-i18n="contributions.table.parameter"></th> <th data-i18n="contributions.table.salatiso"></th> <th data-i18n="contributions.table.tee"></th> <th data-i18n="contributions.table.details"></th> </tr></thead> <tbody id="contributionsTableBody"></tbody> </table> </div>
                        </div>
                        <div id="analysis-reinforcement" class="sub-content flex flex-col">
                            <div class="table-wrapper bg-white/80 shadow-md rounded-lg flex-grow"> <table class="min-w-full divide-y divide-gray-200 contribution-table"> <thead class="sticky top-0 bg-rose-50 z-10"><tr> <th data-i18n="reinforcement.table.wordAction"></th> <th data-i18n="reinforcement.table.purpose"></th> <th data-i18n="reinforcement.table.salatisoOccurrences"></th> <th data-i18n="reinforcement.table.teeOccurrences"></th> <th data-i18n="reinforcement.table.jointOccurrences"></th> </tr></thead> <tbody id="reinforcementTableBody"></tbody> </table> </div>
                        </div>
                    </div>
                </section>

                <section id="mediaTravelHub" class="content-section">
                    <div class="section-header"> <h2 data-i18n="nav.mediaTravelHub"></h2> </div>
                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab active-sub-nav" data-subtarget="media-songs" data-i18n="mediaGallery.sharedSongs"></button>
                        <button class="sub-nav-tab" data-subtarget="media-photos" data-i18n="mediaGallery.photoMoments"></button>
                        <button class="sub-nav-tab" data-subtarget="travel-visited" data-i18n="travel.visitedTitle"></button>
                        <button class="sub-nav-tab" data-subtarget="travel-desired" data-i18n="travel.desiredTitle"></button>
                    </div>
                    <div class="section-content-wrapper">
                        <div id="media-songs" class="sub-content active-sub-content"> <div id="songListContainer" class="max-h-full overflow-y-auto pr-1.5 bg-white/80 p-3 rounded-lg shadow"></div> </div>
                        <div id="media-photos" class="sub-content"> <p class="text-xs text-gray-500 mb-2 text-center" data-i18n="mediaGallery.photoNote"></p> <div id="photoGalleryContainer" class="media-gallery-grid max-h-full overflow-y-auto p-0.5"></div> </div>
                        <div id="travel-visited" class="sub-content"> <div id="visitedPlacesContainer" class="space-y-4 max-h-full overflow-y-auto p-0.5"></div> </div>
                        <div id="travel-desired" class="sub-content"> <div id="desiredPlacesContainer" class="space-y-4 max-h-full overflow-y-auto p-0.5"></div> </div>
                    </div>
                </section>

                <section id="connectResolve" class="content-section">
                     <div class="section-header"> <h2 data-i18n="nav.connectResolve"></h2> </div>
                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab active-sub-nav" data-subtarget="connect-feedback" data-i18n="feedback.title"></button>
                        <button class="sub-nav-tab" data-subtarget="connect-actions" data-i18n="relationshipActions.titleShort"></button>
                        <button class="sub-nav-tab" data-subtarget="connect-logs" data-i18n="relationshipActions.logTitle"></button>
                    </div>
                    <div class="section-content-wrapper">
                        <div id="connect-feedback" class="sub-content active-sub-content grid grid-cols-1 md:grid-cols-2 gap-4 overflow-y-auto">
                            <div class="bg-white/80 p-4 rounded-lg shadow-md"> <h3 class="text-lg font-semibold text-gray-700 mb-3" data-i18n="feedback.giveFeedback"></h3> <div> <label for="feedbackSender" class="block text-xs font-medium text-gray-700" data-i18n="feedback.sender"></label> <select id="feedbackSender" class="select-field !text-sm !py-1.5"></select> </div> <div> <label for="feedbackRecipient" class="block text-xs font-medium text-gray-700" data-i18n="feedback.recipient"></label> <select id="feedbackRecipient" class="select-field !text-sm !py-1.5"></select> </div> <div> <label for="feedbackMessage" class="block text-xs font-medium text-gray-700" data-i18n="feedback.message"></label> <textarea id="feedbackMessage" rows="2" class="textarea-field !text-sm"></textarea> </div> <button id="sendFeedbackBtn" class="action-button mt-1.5 w-full !text-sm !py-2" data-i18n="feedback.sendButton"></button> </div>
                            <div class="bg-white/80 p-4 rounded-lg shadow-md flex flex-col"> <h3 class="text-lg font-semibold text-gray-700 mb-3 flex-shrink-0" data-i18n="feedback.receivedFeedback"></h3> <div id="feedbackLogContainer" class="flex-grow overflow-y-auto pr-0.5"></div> </div>
                        </div>
                        <div id="connect-actions" class="sub-content grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3 overflow-y-auto p-1.5">
                            <div class="relationship-action-form !p-3"> <h4 data-i18n="relationshipActions.apology.title" class="!text-base !mb-2"></h4> <select id="apologyFrom" class="select-field !text-sm !py-1.5 mb-1.5"></select> <textarea id="apologyMessage" class="textarea-field !min-h-[50px] !text-sm" data-i18n-placeholder="relationshipActions.apology.messagePlaceholder"></textarea> <button id="sendApologyBtn" class="action-button mt-1 w-full !text-xs !py-1.5" data-i18n="relationshipActions.apology.sendButton"></button> </div>
                            <div class="relationship-action-form !p-3"> <h4 data-i18n="relationshipActions.dissatisfaction.title" class="!text-base !mb-2"></h4> <select id="dissatisfactionFrom" class="select-field !text-sm !py-1.5 mb-1.5"></select> <textarea id="dissatisfactionMessage" class="textarea-field !min-h-[50px] !text-sm" data-i18n-placeholder="relationshipActions.dissatisfaction.messagePlaceholder"></textarea> <button id="sendDissatisfactionBtn" class="action-button mt-1 w-full !text-xs !py-1.5" data-i18n="relationshipActions.dissatisfaction.sendButton"></button> </div>
                            <div class="relationship-action-form !p-3"> <h4 data-i18n="relationshipActions.bookDate.title" class="!text-base !mb-2"></h4> <select id="dateBooker" class="select-field !text-sm !py-1.5 mb-1.5"></select> <input type="text" id="dateActivity" class="input-field !text-sm" data-i18n-placeholder="relationshipActions.bookDate.activityPlaceholder"> <input type="date" id="dateProposedDate" class="input-field !text-sm"> <button id="proposeDateBtn" class="action-button mt-1 w-full !text-xs !py-1.5" data-i18n="relationshipActions.bookDate.proposeButton"></button> </div>
                            <div class="relationship-action-form border-red-400 border-2 !p-3"> <h4 class="!text-red-600 !text-base !mb-2" data-i18n="relationshipActions.terminate.title"></h4> <select id="terminator" class="select-field !text-sm !py-1.5 mb-1.5"></select> <label for="terminationReason" class="block text-xs font-medium text-gray-700" data-i18n="relationshipActions.terminate.reason"></label> <select id="terminationReason" class="select-field !text-sm !py-1.5 mb-1.5"></select> <textarea id="terminationOtherReason" class="textarea-field !min-h-[40px] !text-sm" data-i18n-placeholder="relationshipActions.terminate.otherReasonPlaceholder"></textarea> <button id="initiateTerminationBtn" class="action-button bg-red-600 hover:bg-red-700 mt-1 w-full !text-xs !py-1.5" data-i18n="relationshipActions.terminate.initiateButton"></button> </div>
                        </div>
                         <div id="connect-logs" class="sub-content bg-white/80 p-3 rounded-lg shadow-md"> <h3 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="relationshipActions.logTitleShort"></h3> <div id="relationshipActionLogContainer" class="max-h-full overflow-y-auto pr-0.5"></div> </div>
                    </div>
                </section>

                <section id="lifesyncFun" class="content-section">
                    <div class="section-header"> <h2 data-i18n="nav.lifesyncFun"></h2> </div>
                    <div class="sub-nav-tabs">
                        <button class="sub-nav-tab active-sub-nav" data-subtarget="fun-compatibility" data-i18n="lifesyncFun.compatibility"></button>
                        <button class="sub-nav-tab" data-subtarget="fun-quizzes" data-i18n="funtools.quizzes.title"></button>
                        <button class="sub-nav-tab" data-subtarget="lifesync-reports" data-i18n="lifesync.title"></button>
                    </div>
                    <div class="section-content-wrapper">
                        <div id="fun-compatibility" class="sub-content active-sub-content overflow-y-auto p-1.5">
                            <div class="bg-white/80 p-4 rounded-lg shadow-md mb-4">
                                <h3 class="text-lg font-semibold text-gray-700 mb-3" data-i18n="funtools.astrology.title"></h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-3 mb-3"> <div><label for="salatisoBday" class="block text-xs font-medium text-gray-700" data-i18n="funtools.astrology.salatisoBday"></label><input type="date" id="salatisoBday" value="1982-09-16" class="input-field !text-sm"></div> <div><label for="teeBday" class="block text-xs font-medium text-gray-700" data-i18n="funtools.astrology.teeBday"></label><input type="date" id="teeBday" value="1990-05-05" class="input-field !text-sm"></div> </div>
                                <button id="checkAstrologyBtn" class="action-button block mx-auto mb-2 !text-xs !py-1.5" data-i18n="funtools.astrology.checkButton"></button>
                                <div id="astrologyResult" class="p-2.5 bg-rose-50/70 rounded text-gray-700 min-h-[30px] text-sm"></div>
                            </div>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                <div class="bg-white/80 p-3 rounded-lg shadow-md text-center"> <h4 class="text-base font-semibold text-gray-700 mb-1.5" data-i18n="compatibilityTests.values.title"></h4> <p class="text-xs text-gray-500 mb-2" data-i18n="compatibilityTests.values.description"></p> <button class="action-button secondary-button !text-xs !py-1" data-i18n="compatibilityTests.startTest"></button> </div>
                                <div class="bg-white/80 p-3 rounded-lg shadow-md text-center"> <h4 class="text-base font-semibold text-gray-700 mb-1.5" data-i18n="compatibilityTests.communication.title"></h4> <p class="text-xs text-gray-500 mb-2" data-i18n="compatibilityTests.communication.description"></p> <button class="action-button secondary-button !text-xs !py-1" data-i18n="compatibilityTests.startTest"></button> </div>
                                <div class="bg-white/80 p-3 rounded-lg shadow-md text-center"> <h4 class="text-base font-semibold text-gray-700 mb-1.5" data-i18n="compatibilityTests.proverbs.title"></h4> <p class="text-xs text-gray-500 mb-2" data-i18n="compatibilityTests.proverbs.description"></p> <button class="action-button secondary-button !text-xs !py-1" data-i18n="compatibilityTests.startTest"></button> </div>
                            </div>
                        </div>
                        <div id="fun-quizzes" class="sub-content text-center"> <h3 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="funtools.quizzes.title"></h3> <p class="text-gray-600 text-sm" data-i18n="funtools.quizzes.placeholder"></p> </div>
                        <div id="lifesync-reports" class="sub-content text-center"> <h3 class="text-lg font-semibold text-gray-700 mb-2" data-i18n="lifesync.reportGen"></h3> <div class="inline-flex items-center space-x-2"> <select id="lifesyncPeriodSelect" class="select-field w-auto !py-1.5 !text-sm"></select> <button class="action-button !py-2 !text-sm" data-i18n="lifesync.generateButton" id="generateReportBtn"></button> </div> <p class="mt-3 text-xs text-gray-600" data-i18n="lifesync.reportNote"></p> </div>
                    </div>
                </section>
            </main>
        </div>

        <footer class="bg-white/95 border-t border-gray-200/80 z-30 py-2 fixed bottom-0 left-0 w-full">
            <div class="container mx-auto px-6 text-center text-gray-500 text-xs">
                <p>© <span id="currentYear"></span> <span data-i18n="footer.text"></span></p>
            </div>
        </footer>
    </div>

    <div id="detailsModal" class="modal"> <div class="modal-content"> <span class="close-button" id="closeModalButton">×</span> <h3 id="modalTitle" class="text-xl font-semibold mb-4 text-rose-600"></h3> <div id="modalBody" class="text-gray-700"> <div class="relative"> <button id="modal-carousel-prev" class="carousel-nav-btn prev !left-[-15px] !w-8 !h-8"><i class="fas fa-chevron-left text-sm"></i></button> <div id="modalCarouselContainer" class="carousel-container messages-carousel max-h-[65vh] overflow-y-auto"></div> <button id="modal-carousel-next" class="carousel-nav-btn next !right-[-15px] !w-8 !h-8"><i class="fas fa-chevron-right text-sm"></i></button> </div> </div> </div> </div>
    <div id="customAlertModal" class="modal"> <div class="modal-content !max-w-sm text-center"> <span class="close-button" id="customAlertCloseButton">×</span> <h3 id="customAlertTitle" class="text-lg font-semibold mb-3 text-rose-600"></h3> <p id="customAlertMessage" class="text-gray-700 mb-4 text-sm"></p> <button id="customAlertOkButton" class="action-button mt-2 mx-auto !text-sm !px-4 !py-1.5">OK</button> </div> </div>
    <div id="playlistModal" class="modal"> <div class="modal-content"> <span class="close-button" id="closePlaylistModal">×</span> <h3 class="text-xl font-semibold mb-3 text-rose-600" data-i18n="playlist.title"></h3> <div class="aspect-w-16 aspect-h-9"> <iframe id="playlistFrame" width="100%" height="315" frameborder="0" allowfullscreen allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe> </div> <p class="mt-2 text-xs text-gray-500" data-i18n="playlist.note"></p> </div> </div>
    <button id="playlistButton" title="Our Playlist"> <i class="fas fa-music text-lg"></i> </button>

    <script src="xh_translations.js"></script>
    <script>
        // --- i18next Configuration ---
        const translations = {
            en: {
                translation: { 
                    websiteTitle: "Tee & Me - Our Story", headerTitle: "Tee & Me",
                    nav: { overview: "Overview", analysisHub: "Analysis Hub", mediaTravelHub: "Media & Travel", connectResolve: "Connect & Resolve", lifesyncFun: "LifeSync & Fun" },
                    overview: { title: "Our Journey Snapshot", dashboardTitle: "Dashboard", affectionLevel: "Affection", supportScore: "Support", foodContribution: "Food Prep", safetyFeeling: "Safety", ourSong: "Our Song", songName_shaggy: "\"Thank You Baby! (For Makin' Someday Come So Soon)\"", listenToSong: "Listen", quickTimeline: "Quick Timeline" },
                    analysisHub: { tracking: "Tracking", contributions: "Contributions", reinforcement: "Reinforcement" },
                    tracking: { selectAspect: "Track:", affectionLevel: "Affection", supportScore: "Support", communicationFrequency: "Communication", foodContribution: "Food Prep", safetyFeeling: "Safety Score", financialTeamwork: "Finances", feedbackResponseTime: "Feedback Response", noResponseData: "No response data" },
                    contributions: { filterWeek: "Week:", table: { parameter: "Parameter", salatiso: "Salatiso", tee: "Tee", details: "Details" }, params: { food: "Food", safety: "Safety", chores: "Chores", planning: "Planning", finances: "Finances", affection: "Affection", support: "Support", communication: "Communication" }, aggregationNote: "(Aggregated reports via LifeSync - Placeholder)", noDataForWeek: "No data for this week.", noneReported: "N/A" },
                    reinforcement: { table: { wordAction: "Word/Action", purpose: "Purpose", salatisoOccurrences: "Salatiso (Wks)", teeOccurrences: "Tee (Wks)", jointOccurrences: "Joint (Wks)"}, words: { safe: "'I'm safe'", loveYou: "'I love you'", helpRequest: "Help Request" }, purpose: { reassurance: "Reassurance", affection: "Affection", supportSeeking: "Support" }},
                    mediaGallery: { sharedSongs: "Shared Songs", photoMoments: "Photo Moments", photoNote: "(Photos from assets/photos/)", noSongs: "No songs logged.", noPhotos: "No photos in assets." },
                    travel: { visitedTitle: "Visited", desiredTitle: "Dream Trips", rolesTitle: "Roles:", highlightsTitle: "Highlights:", noVisited: "No past travels.", noDesired: "No dream trips yet." },
                    connectResolve: {}, 
                    relationshipActions: { titleShort: "Actions", logTitleShort: "Actions Log", title: "Connect & Resolve", salatiso: "Salatiso", tee: "Tee", apology: { title: "Make an Apology", from: "From:", messagePlaceholder: "Your heartfelt apology...", sendButton: "Send Apology", success: "Apology sent." }, dissatisfaction: { title: "Express Dissatisfaction", from: "From:", messagePlaceholder: "Describe your dissatisfaction...", sendButton: "Log Dissatisfaction", success: "Dissatisfaction logged." }, bookDate: { title: "Book a Date", booker: "Booked by:", activityPlaceholder: "E.g., Dinner at [Restaurant]", proposeButton: "Propose Date", success: "Date proposal logged." }, terminate: { title: "Initiate Termination", terminator: "Initiated by:", reason: "Reason:", reasons: { irreconcilable: "Irreconcilable Differences", communication: "Communication Breakdown", paths: "Different Life Paths", other: "Other" }, otherReasonPlaceholder: "Specify other reason...", initiateButton: "Initiate Termination", success: "Termination initiated.", confirmMessage: "Are you sure you want to initiate termination?", specifyOther: "Please specify 'Other' reason." }, logTitle: "Relationship Actions Log", actionBy: "Action by {actor}", actionType: "Type: {type}", actionDetails: "Details: {details}", noActionsYet: "No actions logged." },
                    lifesyncFun: { compatibility: "Compatibility Checks", /* other keys */ },
                    funtools: { quizzes: { title: "Quizzes" }, astrology: { title: "Astrology", salatisoBday: "Salatiso's Bday:", teeBday: "Tee's Bday:", checkButton: "Check", invalidDate: "Invalid dates.", salatisoIsA: "Salatiso:", teeIsA: "Tee:", virgoTaurus: "Virgo & Taurus: Earthy & Stable!", general: "Explore your unique dynamic!" } },
                    compatibilityTests: { startTest: "Start Test", values: { title: "Values Alignment", description: "Align your core values." }, communication: { title: "Communication Styles", description: "Understand communication." }, proverbs: { title: "African Proverbs Wisdom", description: "Wisdom from proverbs." }, comingSoon: "Test coming soon!" },
                    lifesync: { title: "LifeSync", reportGen: "Generate Report", last3Months: "Last 3 Months", last6Months: "Last 6 Months", lastYear: "Last Year", allTime: "All Time", generateButton: "Generate", reportNote: "(Report generation is a placeholder.)" },
                    insights: { title: "Insights" }, // Simplified as it's merged
                    feedback: { title: "Feedback", giveFeedback: "Give Feedback", sender: "Sender:", recipient: "Recipient:", tee: "Tee", salatiso: "Salatiso", message: "Message:", sendButton: "Send", receivedFeedback: "Received / Log", feedbackFrom: "From {sender}", respondedIn: "Responded: {duration}", pendingResponse: "Pending", markAsRead: "Acknowledge", messageEmpty: "Message empty.", success: "Feedback sent.", senderRecipientSame: "Sender/recipient same.", noFeedbackYet: "No feedback yet." },
                    footer: { text: "Tee & Me. A digital chronicle of our love." },
                    modal: { detailsTitle: "Details for Week {weekNumber}" },
                    alert: { defaultTitle: "Notification", actionLogged: "Action Logged", fillAllFields: "Please fill fields.", messageEmpty: "Message empty." },
                    playlist: { title: "Our Playlist", note: "If embed fails, opens in new tab." }
                }
            },
            xh: { translation: typeof xhosaTranslations !== 'undefined' ? xhosaTranslations : {} }
        };
        
        let currentSection = 'overview';
        let currentSubTargets = {}; 
        let dashboardChart, trackingChart;
        let overviewImageCarouselIndex = 0;
        let overviewImageInterval;
        let currentModalCarouselIndex = 0; 
        let modalCarouselItems = [];

        function initializeApp() {
            console.log("App Initializing V6...");
            i18next.use(i18nextBrowserLanguageDetector).init({
                debug: false, fallbackLng: 'en', resources: translations
            }, (err, t) => {
                if (err) { console.error("i18next initialization error:", err); return; }
                
                populateAllSelects();
                updateNavStickiness();
                setupEventListeners();
                navigateToSection('overview'); 
                updateContentAll(); 
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                console.log("App Initialized V6.");
            });
        }

        function populateAllSelects() {
            const overviewMetrics = { affection: "overview.affectionLevel", support: "overview.supportScore", communication: "tracking.communicationFrequency", food: "overview.foodContribution", safety: "overview.safetyFeeling", finances: "overview.financialTeamwork" };
            const trackingMetrics = { ...overviewMetrics, feedback_response: "tracking.feedbackResponseTime" };
            const nameOptions = { Salatiso: "relationshipActions.salatiso", Tee: "relationshipActions.tee" };
            const lifesyncPeriods = { last3Months: "lifesync.last3Months", last6Months: "lifesync.last6Months", lastYear: "lifesync.lastYear", allTime: "lifesync.allTime" };

            populateSelectWithOptions('dashboardMetricSelect', overviewMetrics);
            populateSelectWithOptions('trackingMetricSelect', trackingMetrics);
            populateSelectWithOptions('apologyFrom', nameOptions);
            populateSelectWithOptions('dissatisfactionFrom', nameOptions);
            populateSelectWithOptions('dateBooker', nameOptions);
            populateSelectWithOptions('terminator', nameOptions);
            populateSelectWithOptions('feedbackSender', nameOptions);
            populateSelectWithOptions('feedbackRecipient', nameOptions);
            populateSelectWithOptions('lifesyncPeriodSelect', lifesyncPeriods);
        
            const termReasonSelect = document.getElementById('terminationReason');
            if(termReasonSelect && translations.en.translation.relationshipActions?.terminate?.reasons) {
                const terminationReasonsData = translations.en.translation.relationshipActions.terminate.reasons;
                Object.keys(terminationReasonsData).forEach(key => {
                    const option = document.createElement('option'); option.value = key;
                    option.dataset.i18n = `relationshipActions.terminate.reasons.${key}`; termReasonSelect.appendChild(option);
                });
            }
        }

        function populateSelectWithOptions(selectId, optionsObject) { /* ... (V5 version) ... */ }
        function updateNavStickiness() { /* ... (V5 version, ensure contentAreaWrapper padding is set) ... */ }

        const relationshipData = { /* ... (V5 data structure, ensure it's populated by user) ... */ 
             playlistUrl: "https://music.youtube.com/playlist?list=PLXPU1hLJ2t0MZKrDGjGxk7vNlVeh9pX0C&si=ZPqinjcSRBsq8FZZ", 
            photoFileNames: ["placeholder1.jpg", "placeholder2.jpg", "placeholder3.jpg", "placeholder4.jpg", "placeholder5.jpg"],
            weeks: [ { weekNumber: 1, startDate: "2024-05-20", contributions: { affection: { salatiso: 7, tee: 8}, food: {salatisoActions:["Groceries"], teeActions:["Cooked twice"], score:7}}, summaryKey: "timeline.week1.summary", events: [{type:"music", songTitle:"Our Song", artist:"Us", songUrl:"https://youtu.be/DOcCQ-kC4iE?si=DrJURhh0p86ce7yt", sharedBy:"Salatiso"}]} ],
            reinforcementWords: [], insightsData: [], feedbackLog: [], actionLog: [], travelLog: []
        };

        function navigateToSection(sectionId) { /* ... (V5 version) ... */ }
        function navigateToSubSection(mainSectionId, subTargetId) { /* ... (V5 version, ensure specific render calls are correct) ... */ }
        
        function renderOverviewSection() { /* ... (V5 version) ... */ }
        function renderAnalysisHub() { /* ... (V5 version) ... */ }
        // Add render functions for new hubs: renderMediaTravelHub, renderConnectResolve, renderLifesyncFun
        // These will call navigateToSubSection for their default sub-tab.

        function renderOverviewTimelineCarousel() { /* ... (V5 version) ... */ }
        function renderOverviewImageCarousel() { /* ... (V5 version) ... */ }
        function showOverviewImage(index) { /* ... (V5 version) ... */ }
        function nextOverviewImage() { /* ... (V5 version) ... */ }
        function prevOverviewImage() { /* ... (V5 version) ... */ }
        function shuffleArray(array) { /* ... (V5 version) ... */ }
        function addSeeDetailsListeners() { /* ... (V5 version, ensure handleSeeDetailsClick is robust) ... */ }
        function handleSeeDetailsClick() { /* ... (V5 version) ... */ }
        function renderModalCarousel() { /* ... (V5 version, ensure robustness and correct display) ... */ }
        function renderReinforcementTable() { /* ... (V5 version) ... */ }
        function renderContributionsTable(weekNum) { /* ... (V5 version, ensure robustness) ... */ }
        function renderMediaGallery() { /* ... (V5 version) ... */ }
        function renderTravelSection() { /* ... (V5 version) ... */ }
        function renderFeedbackLog() { /* ... (V5 version) ... */ }
        function renderRelationshipActionLog() { /* ... (V5 version) ... */ }
        function updateDashboardMetrics() { /* ... (V5 version) ... */ }
        function updateDashboardChart(metricKey = 'affection') { /* ... (V5 version) ... */ }
        function updateTrackingChart(metricKey = 'affection') { /* ... (V5 version) ... */ }
        function getZodiacSign(date) { /* ... (V5 version) ... */ }
        function logRelationshipAction(type, actor, target, message, details = {}) { /* ... (V5 version) ... */ }
        function showAlert(message, title) { /* ... (V5 version) ... */ }

        function setupEventListeners() { /* ... (V5 version, ensure all interactive elements are covered) ... */ }
        function handleNavClick() { /* ... (V5 version) ... */ }
        function handleSubNavClick() { /* ... (V5 version) ... */ }
        
        function updateContentAll() { /* ... (V5 version, ensure robustness and correct re-rendering of active components) ... */ }

        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
