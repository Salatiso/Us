<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>LifeSync: Mdeni Family Relationship Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Google Fonts for modern look -->
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap" rel="stylesheet">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
  <style>
    :root {
      --primary: #1a237e;
      --accent: #ffb300;
      --bg: #f5f5f5;
      --card: #fff;
      --timeline: #3949ab;
      --text: #222;
      --tab-active: #ffb300;
      --tab-inactive: #e0e0e0;
      --border-radius: 18px;
    }
    body {
      margin: 0;
      font-family: 'Montserrat', sans-serif;
      background: var(--bg);
      color: var(--text);
      overflow: hidden;
    }
    #app {
      height: 100vh;
      width: 100vw;
      display: flex;
      flex-direction: column;
    }
    /* Tabs */
    .tabs {
      display: flex;
      background: var(--card);
      border-bottom: 2px solid var(--timeline);
      justify-content: space-between;
      align-items: center;
      padding: 0 2vw;
      height: 60px;
    }
    .tab {
      flex: 1;
      text-align: center;
      padding: 18px 0;
      cursor: pointer;
      font-weight: 700;
      font-size: 1.1em;
      color: var(--primary);
      background: var(--tab-inactive);
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      margin: 0 8px;
      transition: background 0.2s;
    }
    .tab.active {
      background: var(--tab-active);
      color: #fff;
    }
    .lang-switch {
      font-size: 1.2em;
      cursor: pointer;
      margin-left: 12px;
      color: var(--primary);
      background: none;
      border: none;
    }
    /* Content panels */
    .panel {
      flex: 1;
      display: none;
      overflow: hidden;
      position: relative;
    }
    .panel.active {
      display: block;
      animation: fadein 0.4s;
    }
    @keyframes fadein {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    /* Dashboard */
    .dashboard {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      align-items: center;
      height: 100%;
      gap: 2vw;
      padding: 2vw;
    }
    .card {
      background: var(--card);
      border-radius: var(--border-radius);
      box-shadow: 0 2px 10px rgba(0,0,0,0.08);
      padding: 2vw;
      min-width: 260px;
      min-height: 180px;
      flex: 1 0 320px;
      max-width: 400px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    .card h3 {
      margin: 0 0 12px 0;
      color: var(--primary);
    }
    /* Timeline */
    .timeline-container {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .timeline {
      display: flex;
      flex-direction: row;
      overflow-x: auto;
      overflow-y: hidden;
      height: 90%;
      align-items: center;
      gap: 40px;
      padding: 2vw;
      scroll-behavior: smooth;
    }
    .timeline-event {
      background: var(--card);
      border-radius: var(--border-radius);
      box-shadow: 0 2px 8px rgba(26,35,126,0.09);
      min-width: 260px;
      max-width: 320px;
      padding: 18px 20px;
      position: relative;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
    }
    .timeline-event .icon {
      font-size: 2em;
      color: var(--timeline);
      margin-bottom: 10px;
    }
    .timeline-event .date {
      font-size: 0.95em;
      color: var(--accent);
      margin-bottom: 7px;
    }
    .timeline-event .desc {
      font-size: 1.08em;
      margin-bottom: 8px;
    }
    .timeline-event .link {
      color: var(--primary);
      text-decoration: underline;
      font-size: 0.95em;
      cursor: pointer;
      margin-top: 4px;
    }
    /* Carousel */
    .carousel-container {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: var(--bg);
    }
    .carousel {
      display: flex;
      align-items: center;
      gap: 24px;
      width: 90vw;
      max-width: 900px;
      overflow: hidden;
      position: relative;
    }
    .carousel-message {
      background: var(--card);
      border-radius: var(--border-radius);
      box-shadow: 0 2px 8px rgba(26,35,126,0.09);
      min-width: 350px;
      max-width: 450px;
      padding: 24px 30px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      font-size: 1.08em;
      position: relative;
      transition: box-shadow 0.2s;
    }
    .carousel-message .meta {
      font-size: 0.95em;
      color: var(--accent);
      margin-bottom: 6px;
    }
    .carousel-message .author {
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 8px;
    }
    .carousel-nav {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 44px;
      height: 44px;
      font-size: 1.5em;
      cursor: pointer;
      transition: background 0.2s;
      margin: 0 12px;
    }
    .carousel-nav:active {
      background: var(--accent);
    }
    .carousel-index {
      margin-top: 12px;
      color: var(--timeline);
      font-size: 1.1em;
    }
    /* Responsive */
    @media (max-width: 900px) {
      .dashboard { flex-direction: column; }
      .card { min-width: 90vw; max-width: 95vw; }
      .timeline-event { min-width: 90vw; max-width: 95vw; }
      .carousel-message { min-width: 90vw; max-width: 95vw; }
    }
  </style>
</head>
<body>
  <div id="app">
    <!-- Tabs -->
    <div class="tabs">
      <div class="tab active" data-tab="dashboard"><i class="fas fa-chart-pie"></i> <span class="tr" data-key="dashboard">Dashboard</span></div>
      <div class="tab" data-tab="timeline"><i class="fas fa-stream"></i> <span class="tr" data-key="timeline">Timeline</span></div>
      <div class="tab" data-tab="messages"><i class="fas fa-comments"></i> <span class="tr" data-key="messages">Messages</span></div>
      <div class="tab" data-tab="about"><i class="fas fa-heart"></i> <span class="tr" data-key="about">About</span></div>
      <button class="lang-switch" id="langSwitch" title="Switch language">
        <i class="fas fa-language"></i> <span id="langLabel">Xhosa</span>
      </button>
    </div>
    <!-- Panels -->
    <div class="panel active" id="dashboardPanel">
      <div class="dashboard">
        <div class="card">
          <h3 class="tr" data-key="relationship_health">Relationship Health</h3>
          <canvas id="loveGraph" width="220" height="120"></canvas>
          <div style="margin-top:10px;" class="tr" data-key="love_score">Love Score: <span id="loveScore">98</span>/100</div>
        </div>
        <div class="card">
          <h3 class="tr" data-key="communication">Communication</h3>
          <canvas id="commGraph" width="220" height="120"></canvas>
          <div style="margin-top:10px;" class="tr" data-key="messages_sent">Messages Sent: <span id="msgCount">84</span></div>
        </div>
        <div class="card">
          <h3 class="tr" data-key="crisis_handling">Crisis Handling</h3>
          <canvas id="crisisGraph" width="220" height="120"></canvas>
          <div style="margin-top:10px;" class="tr" data-key="crisis_resolved">Crises Resolved: <span id="crisisCount">5</span></div>
        </div>
      </div>
    </div>
    <div class="panel" id="timelinePanel">
      <div class="timeline-container">
        <div class="timeline" id="timeline">
          <!-- Timeline events injected here -->
        </div>
      </div>
    </div>
    <div class="panel" id="messagesPanel">
      <div class="carousel-container">
        <div style="margin-bottom:12px;text-align:center;">
          <span class="tr" data-key="browse_messages">Browse Key Messages</span>
        </div>
        <div class="carousel">
          <button class="carousel-nav" id="carouselPrev"><i class="fas fa-chevron-left"></i></button>
          <div id="carouselMessage">
            <!-- Message injected here -->
          </div>
          <button class="carousel-nav" id="carouselNext"><i class="fas fa-chevron-right"></i></button>
        </div>
        <div class="carousel-index" id="carouselIndex"></div>
      </div>
    </div>
    <div class="panel" id="aboutPanel">
      <div style="padding:3vw;max-width:700px;margin:0 auto;">
        <h2 class="tr" data-key="about_title">About This Relationship</h2>
        <p class="tr" data-key="about_desc">
          This interactive dashboard chronicles the journey of Salatiso and Tee, blending love, partnership, and enterprise. 
          Explore their timeline, key communications, and the systems that keep their bond strong. 
          All content is available in English and isiXhosa for cultural resonance.
        </p>
        <ul>
          <li class="tr" data-key="no_scroll">No vertical scrolling – everything is at your fingertips.</li>
          <li class="tr" data-key="timelines">Horizontal timeline with icons and links to original messages.</li>
          <li class="tr" data-key="dashboard_custom">Customizable dashboard with relationship analytics.</li>
          <li class="tr" data-key="fully_translatable">Fully translatable: switch between English and isiXhosa instantly.</li>
        </ul>
        <p>
          <span class="tr" data-key="repo_suggestion">For asset management, use the suggested repository structure. All code is open for your customization.</span>
        </p>
      </div>
    </div>
  </div>
  <!-- Chart.js for graphs -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script>
    // --- Data Section ---
    // Timeline Events
    const timelineEvents = [
      {
        date: "2024-05-22",
        icon: "fa-users",
        title: "Relationship Formalized",
        desc: "WhatsApp group 'Us' created. Partnership begins.",
        msgIndex: 0
      },
      {
        date: "2024-05-27",
        icon: "fa-shield-heart",
        title: "Safety Ritual Starts",
        desc: "First daily safety check-in: 'I'm safe sthandwa sam.'",
        msgIndex: 5
      },
      {
        date: "2024-05-28",
        icon: "fa-gavel",
        title: "Legal Coordination",
        desc: "First joint court appearance and legal planning.",
        msgIndex: 10
      },
      {
        date: "2024-06-04",
        icon: "fa-snowflake",
        title: "Winter Adaptation",
        desc: "Bakkie iced over; geyser and home logistics coordinated.",
        msgIndex: 30
      },
      {
        date: "2024-06-26",
        icon: "fa-coins",
        title: "Financial Tracker",
        desc: "Expenditure tracking system planned together.",
        msgIndex: 60
      },
      {
        date: "2024-06-28",
        icon: "fa-notes-medical",
        title: "Health Crisis",
        desc: "Vomiting episode; crisis-handling protocol activated.",
        msgIndex: 75
      },
      {
        date: "2024-06-29",
        icon: "fa-lock",
        title: "Security Alert",
        desc: "Bank app security code changed; joint response.",
        msgIndex: 78
      },
      {
        date: "2024-07-09",
        icon: "fa-globe",
        title: "Website Launch",
        desc: "First website draft shared for enterprise.",
        msgIndex: 100
      }
    ];

    // Key Messages (for carousel)
    const messages = [
      {
        date: "2024-05-22 13:32",
        author: "Salatiso",
        text: "WhatsApp group 'Us' created. Partnership begins.",
        lang: {
          xh: "Iqela le-WhatsApp 'Us' lenziwe. Ubudlelwane buqalile."
        }
      },
      {
        date: "2024-05-27 07:43",
        author: "Tee",
        text: "I'm safe sthandwa sam",
        lang: {
          xh: "Ndikhuselekile sthandwa sam"
        }
      },
      {
        date: "2024-05-28 10:26",
        author: "Salatiso",
        text: "Surprisingly the original magistrate was not there. It went as expected, I have to go again on 10 July. Now I have what I need to approach the equality court.",
        lang: {
          xh: "Ngumangaliso ukuba ijaji yokuqala ibingekho. Kufuneka ndibuye ngo-10 July. Ndinalo ngoku endilidingayo ukuya enkundleni yobulungisa."
        }
      },
      {
        date: "2024-06-04 07:48",
        author: "Tee",
        text: "Please adjust the geyser, I've been showering with cold water. May you please move the bakkie today, windscreen yam had actual ice this morning.",
        lang: {
          xh: "Nceda ulungise i-geyser, bendihlamba ngamanzi abandayo. Nceda ushukumise i-bakkie namhlanje, ifestile ibinemkhenkce."
        }
      },
      {
        date: "2024-06-26 09:57",
        author: "Salatiso",
        text: "Please remind me this weekend to do a financial tracker for your expenditure. This construction is getting out of hand.",
        lang: {
          xh: "Nceda undikhumbuze ngempelaveki ukwenza itraka yezezimali. Ulwakhiwo luyaphuma ezandleni."
        }
      },
      {
        date: "2024-06-28 12:28",
        author: "Salatiso",
        text: "I'm not getting better, quite the opposite. Took some meds, thought they were working... Vomited all of them. Please Uber back.",
        lang: {
          xh: "Andiphili, kumbi ngakumbi. Ndithathe amayeza, ndacinga ukuba ayasebenza... Ndiphose onke. Nceda ubuye nge-Uber."
        }
      },
      {
        date: "2024-06-29 01:45",
        author: "System",
        text: "Your security code with Tee changed.",
        lang: {
          xh: "Ikhowudi yakho yokhuseleko noTee itshintshile."
        }
      },
      {
        date: "2024-07-09 14:02",
        author: "Salatiso",
        text: "Website draft shared: https://grey-alligator-976716.builder-preview.com/",
        lang: {
          xh: "Umzobo wewebhusayithi wabelwana: https://grey-alligator-976716.builder-preview.com/"
        }
      }
    ];

    // --- Translation dictionaries ---
    const translations = {
      en: {
        dashboard: "Dashboard",
        timeline: "Timeline",
        messages: "Messages",
        about: "About",
        relationship_health: "Relationship Health",
        love_score: "Love Score",
        communication: "Communication",
        messages_sent: "Messages Sent",
        crisis_handling: "Crisis Handling",
        crisis_resolved: "Crises Resolved",
        browse_messages: "Browse Key Messages",
        about_title: "About This Relationship",
        about_desc: "This interactive dashboard chronicles the journey of Salatiso and Tee, blending love, partnership, and enterprise. Explore their timeline, key communications, and the systems that keep their bond strong. All content is available in English and isiXhosa for cultural resonance.",
        no_scroll: "No vertical scrolling – everything is at your fingertips.",
        timelines: "Horizontal timeline with icons and links to original messages.",
        dashboard_custom: "Customizable dashboard with relationship analytics.",
        fully_translatable: "Fully translatable: switch between English and isiXhosa instantly.",
        repo_suggestion: "For asset management, use the suggested repository structure. All code is open for your customization."
      },
      xh: {
        dashboard: "Ideshibhodi",
        timeline: "Ixesha",
        messages: "Imiyalezo",
        about: "Malunga",
        relationship_health: "Impilo yobudlelwane",
        love_score: "Inqanaba lothando",
        communication: "Unxibelelwano",
        messages_sent: "Imiyalezo ethunyelweyo",
        crisis_handling: "Ulawulo lweengxaki",
        crisis_resolved: "Iingxaki ezisombululiweyo",
        browse_messages: "Jonga Imiyalezo Ebalulekileyo",
        about_title: "Malunga Nobudlelwane",
        about_desc: "Le deshibhodi intsebenziswano ibalisa uhambo lukaSalatiso noTee, idibanisa uthando, intsebenziswano, kunye noshishino. Jonga ixesha labo, unxibelelwano oluphambili, kunye neenkqubo eziqinisa ubudlelwane babo. Konke oku kufumaneka ngesiNgesi nesiXhosa.",
        no_scroll: "Akukho skrola phezulu/ezantsi – yonke into isondele kuwe.",
        timelines: "Ixesha elithe tye elineempawu kunye nekhonkco kwimiyalezo yoqobo.",
        dashboard_custom: "Ideshibhodi enokwenziwa ngokwezifiso kunye nohlalutyo lobudlelwane.",
        fully_translatable: "Iyaguqulelwa ngokupheleleyo: tshintsha phakathi kwesiNgesi nesiXhosa kwangoko.",
        repo_suggestion: "Ukugcina iiasethi, sebenzisa ulwakhiwo lwe-repository olucetyisiweyo. Ikhowudi yonke ivulekile ukuze uyilungise."
      }
    };

    // --- State ---
    let currentTab = "dashboard";
    let currentLang = "en";
    let carouselIdx = 0;

    // --- Tab Switching ---
    document.querySelectorAll('.tab').forEach(tab => {
      tab.onclick = function() {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentTab = tab.getAttribute('data-tab');
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        document.getElementById(currentTab + "Panel").classList.add('active');
      };
    });

    // --- Language Switching ---
    function setLang(lang) {
      currentLang = lang;
      // Update all .tr elements
      document.querySelectorAll('.tr').forEach(el => {
        const key = el.getAttribute('data-key');
        if (translations[lang][key]) {
          el.textContent = translations[lang][key];
        }
      });
      // Update lang label
      document.getElementById('langLabel').textContent = (lang === 'en') ? 'Xhosa' : 'English';
      // Update timeline and carousel
      renderTimeline();
      renderCarousel();
    }
    document.getElementById('langSwitch').onclick = function() {
      setLang(currentLang === "en" ? "xh" : "en");
    };

    // --- Timeline Rendering ---
    function renderTimeline() {
      const timeline = document.getElementById('timeline');
      timeline.innerHTML = '';
      timelineEvents.forEach((event, idx) => {
        const msg = messages[event.msgIndex];
        const title = (currentLang === "xh" && msg.lang && msg.lang.xh) ? msg.lang.xh : event.title;
        const desc = (currentLang === "xh" && msg.lang && msg.lang.xh) ? msg.lang.xh : event.desc;
        timeline.innerHTML += `
          <div class="timeline-event">
            <div class="icon"><i class="fas ${event.icon}"></i></div>
            <div class="date">${event.date}</div>
            <div class="desc"><b>${title}</b></div>
            <div class="desc">${desc}</div>
            <div class="link" onclick="goToMessage(${event.msgIndex})">${currentLang === 'xh' ? 'Jonga umyalezo' : 'View message'}</div>
          </div>
        `;
      });
    }
    window.goToMessage = function(idx) {
      // Switch to messages tab and show the message at idx
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelector('.tab[data-tab="messages"]').classList.add('active');
      document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
      document.getElementById("messagesPanel").classList.add('active');
      carouselIdx = idx;
      renderCarousel();
    };

    // --- Carousel Rendering ---
    function renderCarousel() {
      const msg = messages[carouselIdx];
      const text = (currentLang === "xh" && msg.lang && msg.lang.xh) ? msg.lang.xh : msg.text;
      document.getElementById('carouselMessage').innerHTML = `
        <div class="carousel-message">
          <div class="meta">${msg.date}</div>
          <div class="author">${msg.author}</div>
          <div class="text">${text}</div>
        </div>
      `;
      document.getElementById('carouselIndex').textContent = `${carouselIdx + 1} / ${messages.length}`;
    }
    document.getElementById('carouselPrev').onclick = function() {
      carouselIdx = (carouselIdx - 1 + messages.length) % messages.length;
      renderCarousel();
    };
    document.getElementById('carouselNext').onclick = function() {
      carouselIdx = (carouselIdx + 1) % messages.length;
      renderCarousel();
    };

    // --- Dashboard Graphs ---
    function renderGraphs() {
      // Love Score
      new Chart(document.getElementById('loveGraph'), {
        type: 'doughnut',
        data: {
          labels: ['Love', 'Other'],
          datasets: [{
            data: [98, 2],
            backgroundColor: [ '#ffb300', '#e0e0e0' ]
          }]
        },
        options: { cutout: '70%', plugins: { legend: { display: false } } }
      });
      // Communication
      new Chart(document.getElementById('commGraph'), {
        type: 'bar',
        data: {
          labels: ['May', 'June', 'July'],
          datasets: [{
            label: 'Messages',
            data: [10, 60, 14],
            backgroundColor: [ '#1a237e', '#ffb300', '#3949ab' ]
          }]
        },
        options: { plugins: { legend: { display: false } } }
      });
      // Crisis Handling
      new Chart(document.getElementById('crisisGraph'), {
        type: 'pie',
        data: {
          labels: ['Resolved', 'Pending'],
          datasets: [{
            data: [5, 0],
            backgroundColor: [ '#1a237e', '#e0e0e0' ]
          }]
        },
        options: { plugins: { legend: { display: false } } }
      });
      // Update stats
      document.getElementById('loveScore').textContent = 98;
      document.getElementById('msgCount').textContent = 84;
      document.getElementById('crisisCount').textContent = 5;
    }

    // --- Initial Render ---
    renderTimeline();
    renderCarousel();
    renderGraphs();
    setLang('en');
  </script>
</body>
</html>
